package ProjectSTLP_App;

import java.util.List;

import org.openqa.selenium.NoSuchElementException;

import io.appium.java_client.android.AndroidDriver;
import io.appium.java_client.android.AndroidElement;
import ProjectSTLP_App.MyMobileActions;

public class Driver {

	private Utility util = new Utility();
	private double startPercentage = 0.0, endPercentage = 0.0, anchorPercentage = 0.0;
	private int x = 0, y = 0;
	private String number, xPath;
	AndroidDriver driver = null;

	public Utility getUtility() {
		return util;
	}

	public String keyword_executor(String vKeyword, String vIP1, String vIP2) throws Exception {

		String flag = "false";

		try {
			if (vKeyword.equals("apk_open")) {
				util.apk_open(getIP(vIP1));
				flag = "True";
				return "pass";
			}
			if (vKeyword.equals("radio_select")) {
				util.radio_select(getIP(vIP1), getIP(vIP2));
				flag = "True";
				return "pass";
			}
			if (vKeyword.equals("checkbox_set")) {
				util.checkbox_set(getIP(vIP1), getIP(vIP2));
				flag = "True";
				return "pass";
			}
//			if (vKeyword.equals("list_select")) {
//				util.list_select(getIP(vIP1), getIP(vIP2));
//				flag = "True";
//				return "pass";
//			}
			if (vKeyword.equals("edit_input")) {
				util.edit_input(getIP(vIP1), getIP(vIP2));
				flag = "True";
				return "pass";
			}
			if (vKeyword.equals("edit_input_classname")) {
				util.edit_input_classname(getIP(vIP1), getIP(vIP2));
				flag = "True";
				return "pass";
			}
			if (vKeyword.equals("button_click")) {
				String word1 = getIP(vIP1).toString();
				String word2 = getIP(vIP2).toString();
				if (word2.equals("android:id/button3")) {
					util.button_click(getIP(word1));
					Thread.sleep(4000);
					util.apk_close();
					flag = "True";
					return "pass";
				} else {
					util.button_click(getIP(word1));
					flag = "True";
					return "pass";
				}

//				util.button_click(getIP(word1));
//				flag = "True";
//				return "pass";

			}
			if (vKeyword.equals("click_link")) {
				util.click_link(getIP(vIP1));
				flag = "True";
				return "pass";
			}
//			if (vKeyword.equals("dialog_click")) {
//				boolean works = util.dialog_click();
//				if (works) {
//					flag = "True";
//					return "pass";
//				}
//			}
			if (vKeyword.equals("apk_close")) {
				util.apk_close();
				flag = "True";
				return "pass";
			}
			if (vKeyword.equals("verticalSwipeByPercentages")) {
				String number = getIP(vIP1).toString();
				String[] key = number.split(",");
				startPercentage = Double.parseDouble(key[0]);
				endPercentage = Double.parseDouble(key[1]);
				anchorPercentage = Double.parseDouble(key[2]);
				util.verticalSwipeByPercentages(startPercentage, endPercentage, anchorPercentage);
				flag = "True";
				return "pass";
			}
			if (vKeyword.equals("swipeByElements")) {
				String xPath = getIP(vIP1).toString();
				List<AndroidElement> list = driver.findElementsById(xPath);
				util.swipeByElements(list.get(list.size() - 1), list.get(0));

				flag = "True";
				return "pass";
			}
			if (vKeyword.equals("tapByCoordinates")) {
				String number = getIP(vIP1).toString();
				String[] key = number.split(",");
				x = Integer.parseInt(key[0]);
				y = Integer.parseInt(key[1]);

				util.tapByCoordinates(x, y);

				flag = "True";
				return "pass";
			}
			if (vKeyword.equals("tapByCoordinates_Confirm")) {
				try {
					String number = getIP(vIP1).toString();
					String xPath = getIP(vIP2).toString();

					String[] key = number.split(",");
					x = Integer.parseInt(key[0]);
					y = Integer.parseInt(key[1]);

					util.tapByCoordinates(x, y);

					util.button_click(xPath);

					flag = "True";
					return "pass";
				} catch (Exception e) {
					e.printStackTrace();
					util.apk_close();
					System.out.println("Keyword Error !!" + getIP(vIP1).toString());
				}

			}
			if (vKeyword.equals("edittext_tapByCoordinates")) {
				try {
					number = getIP(vIP1).toString();
					xPath = getIP(vIP2).toString();

					String[] key = number.split(",");
					x = Integer.parseInt(key[0]);
					y = Integer.parseInt(key[1]);

					System.out.println(x);
					System.out.println(y);

					util.tapByCoordinates(x, y);

					util.edit_input("android.widget.EditText", getIP(vIP2));

					flag = "True";
					return "pass";
				} catch (Exception e) {
					e.printStackTrace();
					util.apk_close();
					System.out.println("Keyword Error !!" + getIP(vIP1).toString());
				}

			}

			if (vKeyword.equals("datepicker")) {
				util.datepicker(getIP(vIP1), getIP(vIP2));
				flag = "True";
				return "pass";
			}

			if (flag.equals("false")) {
				System.out.println("**Fail ==> Keyword : [" + vKeyword + "] !!!!!!!!!");
				System.out.println("=====================================================");
				StartUp.vError = "Error"; // à¹?à¸?à¹?à¹?à¸?à¹€à¸?à¸´à¹?à¸¡à¹€à¸•à¸´à¸¡
				return "False-Keyword Missing";
			}

		} catch (NoSuchElementException e) {
			System.out.println("Error is : " + e);
			StartUp.vError = String.valueOf(e);

			return "Fail";
		}
		return "Unknown Keyword";
	}

	public String getIP(String vIP) {

		if (vIP.equals("vAPK")) {
			vIP = StartUp.vAPK;
		}
		if (vIP.equals("vClose")) {
			vIP = StartUp.vClose;
		}
		if (vIP.equals("vPersonID")) {
			vIP = StartUp.vPersonID;
		}
		if (vIP.equals("vName")) {
			vIP = StartUp.vName;
		}
		if (vIP.equals("vTelephone")) {
			vIP = StartUp.vTelephone;
		}
		if (vIP.equals("vReligion")) {
			vIP = StartUp.vReligion;
		}
		if (vIP.equals("vEthnicity")) {
			vIP = StartUp.vEthnicity;
		}
		if (vIP.equals("vNationnality")) {
			vIP = StartUp.vNationnality;
		}
		if (vIP.equals("vHouse")) {
			vIP = StartUp.vHouse;
		}
		if (vIP.equals("vidCard")) {
			vIP = StartUp.vidCard;
		}
		if (vIP.equals("vEmail")) {
			vIP = StartUp.vEmail;
		}
		if (vIP.equals("vAddress")) {
			vIP = StartUp.vAddress;
		}
		if (vIP.equals("vAddressNow")) {
			vIP = StartUp.vAddressNow;
		}
		if (vIP.equals("vStartAddressNow")) {
			vIP = StartUp.vStartAddressNow;
		}
		if (vIP.equals("vEndAddressNow")) {
			vIP = StartUp.vEndAddressNow;
		}
		if (vIP.equals("vAddressBefore")) {
			vIP = StartUp.vAddressBefore;
		}
		if (vIP.equals("vStartAddressBefore")) {
			vIP = StartUp.vStartAddressBefore;
		}
		if (vIP.equals("vEndAddressBefore")) {
			vIP = StartUp.vEndAddressBefore;
		}
		if (vIP.equals("vEducation")) {
			vIP = StartUp.vEducation;
		}
		if (vIP.equals("vNameFather")) {
			vIP = StartUp.vNameFather;
		}
		if (vIP.equals("vidCardFather")) {
			vIP = StartUp.vidCardFather;
		}
		if (vIP.equals("vEthnicityFather")) {
			vIP = StartUp.vEthnicityFather;
		}
		if (vIP.equals("vNationnalityFather")) {
			vIP = StartUp.vNationnalityFather;
		}
		if (vIP.equals("vAddressFather")) {
			vIP = StartUp.vAddressFather;
		}
		if (vIP.equals("vNameMother")) {
			vIP = StartUp.vNameMother;
		}
		if (vIP.equals("vidCardMother")) {
			vIP = StartUp.vidCardMother;
		}
		if (vIP.equals("vEthnicityMother")) {
			vIP = StartUp.vEthnicityMother;
		}
		if (vIP.equals("vNationnalityMother")) {
			vIP = StartUp.vNationnalityMother;
		}
		if (vIP.equals("vAddressMother")) {
			vIP = StartUp.vAddressMother;
		}
		if (vIP.equals("vUsername")) {
			vIP = StartUp.vUsername;
		}
		if (vIP.equals("vPassword")) {
			vIP = StartUp.vPassword;
		}
		if (vIP.equals("vConfirmPassword")) {
			vIP = StartUp.vConfirmPassword;
		}
		if (vIP.equals("vMoreRequest")) {
			vIP = StartUp.vMoreRequest;
		}
		if (vIP.equals("vConfirm")) {
			vIP = StartUp.vConfirm;
		}
		if (vIP.equals("vSelectStaff")) {
			vIP = StartUp.vSelectStaff;
		}
		if (vIP.equals("vConfirmProcess")) {
			vIP = StartUp.vConfirmProcess;
		}
		if (vIP.equals("vRadioBirthvRadioBirth")) {
			vIP = StartUp.vRadioBirth;
		}
		if (vIP.equals("vRadioIdCard")) {
			vIP = StartUp.vRadioIdCard;
		}
		if (vIP.equals("vRadioCenter")) {
			vIP = StartUp.vRadioCenter;
		}
		if (vIP.equals("vRadioRegis")) {
			vIP = StartUp.vRadioRegis;
		}
		if (vIP.equals("vChkBirth")) {
			vIP = StartUp.vChkBirth;
		}
		if (vIP.equals("vFact")) {
			vIP = StartUp.vFact;
		}
		if (vIP.equals("vFactMotherFather")) {
			vIP = StartUp.vFactMotherFather;
		}
		if (vIP.equals("vRule")) {
			vIP = StartUp.vRule;
		}
		if (vIP.equals("vStatus")) {
			vIP = StartUp.vStatus;
		}
		if (vIP.equals("vMessage")) {
			vIP = StartUp.vMessage;
		}
		if (vIP.equals("vSex")) {
			vIP = StartUp.vSex;
		}
		if (vIP.equals("vBirthday")) {
			vIP = StartUp.vBirthday;
		}
		if (vIP.equals("vNationality")) {
			vIP = StartUp.vNationality;
		}
		if (vIP.equals("vidCard")) {
			vIP = StartUp.vidCard;
		}
		if (vIP.equals("vRelationship")) {
			vIP = StartUp.vRelationship;
		}
		if (vIP.equals("vDo")) {
			vIP = StartUp.vDo;
		}
		if (vIP.equals("vAccommodation")) {
			vIP = StartUp.vAccommodation;
		}
		if (vIP.equals("vAccommodationNow")) {
			vIP = StartUp.vAccommodationNow;
		}
		if (vIP.equals("vAccommodationBefore")) {
			vIP = StartUp.vAccommodationBefore;
		}
		if (vIP.equals("vStatusFather")) {
			vIP = StartUp.vStatusFather;
		}
		if (vIP.equals("vBirthdayFather")) {
			vIP = StartUp.vBirthdayFather;
		}
		if (vIP.equals("vCountryFather")) {
			vIP = StartUp.vCountryFather;
		}
		if (vIP.equals("vStatusMother")) {
			vIP = StartUp.vStatusMother;
		}
		if (vIP.equals("vBirthdayMother")) {
			vIP = StartUp.vBirthdayMother;
		}
		if (vIP.equals("vCountryMother")) {
			vIP = StartUp.vCountryMother;
		}
		if (vIP.equals("vNameSpouse")) {
			vIP = StartUp.vNameSpouse;
		}
		if (vIP.equals("vidCardSpouse")) {
			vIP = StartUp.vidCardSpouse;
		}
		if (vIP.equals("vNationnalitySpouse")) {
			vIP = StartUp.vNationnalitySpouse;
		}
		if (vIP.equals("vDateMarry")) {
			vIP = StartUp.vDateMarry;
		}
		if (vIP.equals("vAddressSpouse")) {
			vIP = StartUp.vAddressSpouse;
		}

		return vIP;
	}

	public void getData(int k) {
		String namefile[] = { "01_SearchIDCardType", "02_CreateUser", "03_Login"/* , "08_RequestForHelp" */,
				"05_SelectStaffForRequest", "06_GiveSuggestion", /* "04_AddMoreRequest" , */ "07_AnswerMoreRequest" };
		
		for (int i = 0; i <namefile.length ; i++) {
			if (i == 0) {
//		======== SearchIDCardType (01) ========
				StartUp.vAPK = StartUp.xTDdata[k][2];
				StartUp.vPersonID = StartUp.xTDdata[k][3];
				StartUp.vClose = StartUp.xTDdata[k][2];
				StartUp.vDTResult = Integer.parseInt("5");
				StartUp.vDTError = Integer.parseInt("7");
			}
//		======== CreateUser (02) ========		
			if (i == 1) {
				StartUp.vAPK = StartUp.xTDdata[k][2];
				StartUp.vName = StartUp.xTDdata[k][3];
				StartUp.vEmail = StartUp.xTDdata[k][4];
				StartUp.vTelephone = StartUp.xTDdata[k][5];
				StartUp.vSex = StartUp.xTDdata[k][6];
				StartUp.vBirthday = StartUp.xTDdata[k][7];
				StartUp.vReligion = StartUp.xTDdata[k][8];
				StartUp.vEthnicity = StartUp.xTDdata[k][9];
				StartUp.vNationnality = StartUp.xTDdata[k][10];
				StartUp.vHouse = StartUp.xTDdata[k][11];
				StartUp.vidCard = StartUp.xTDdata[k][12];
				StartUp.vRelationship = StartUp.xTDdata[k][13];
				StartUp.vDo = StartUp.xTDdata[k][14];
				StartUp.vAddress = StartUp.xTDdata[k][15];
				StartUp.vAccommodation = StartUp.xTDdata[k][16];
				StartUp.vAddressNow = StartUp.xTDdata[k][17];
				StartUp.vAccommodationNow = StartUp.xTDdata[k][18];
				StartUp.vStartAddressNow = StartUp.xTDdata[k][19];
				StartUp.vEndAddressNow = StartUp.xTDdata[k][20];
				StartUp.vAddressBefore = StartUp.xTDdata[k][21];
				StartUp.vAccommodationBefore = StartUp.xTDdata[k][22];
				StartUp.vStartAddressBefore = StartUp.xTDdata[k][23];
				StartUp.vEndAddressBefore = StartUp.xTDdata[k][24];
				StartUp.vEducation = StartUp.xTDdata[k][25];
				StartUp.vNameFather = StartUp.xTDdata[k][26];
				StartUp.vStatusFather = StartUp.xTDdata[k][27];
				StartUp.vBirthdayFather = StartUp.xTDdata[k][28];
				StartUp.vidCardFather = StartUp.xTDdata[k][29];
				StartUp.vEthnicityFather = StartUp.xTDdata[k][30];
				StartUp.vNationnalityFather = StartUp.xTDdata[k][31];
				StartUp.vCountryFather = StartUp.xTDdata[k][32];
				StartUp.vAddressFather = StartUp.xTDdata[k][33];
				StartUp.vNameMother = StartUp.xTDdata[k][34];
				StartUp.vStatusMother = StartUp.xTDdata[k][35];
				StartUp.vBirthdayMother = StartUp.xTDdata[k][36];
				StartUp.vidCardMother = StartUp.xTDdata[k][37];
				StartUp.vEthnicityMother = StartUp.xTDdata[k][38];
				StartUp.vNationnalityMother = StartUp.xTDdata[k][39];
				StartUp.vCountryMother = StartUp.xTDdata[k][40];
				StartUp.vAddressMother = StartUp.xTDdata[k][41];
				StartUp.vUsername = StartUp.xTDdata[k][42];
				StartUp.vPassword = StartUp.xTDdata[k][43];
				StartUp.vConfirmPassword = StartUp.xTDdata[k][44];
				StartUp.vDTResult = Integer.parseInt("46");
				StartUp.vDTError = Integer.parseInt("48");

			}
//		}

//		======== CreateUser _EnableReletionShip =========
//		StartUp.vAPK = StartUp.xTDdata[k][2];
//		StartUp.vName = StartUp.xTDdata[k][3];
//		StartUp.vEmail = StartUp.xTDdata[k][4];
//		StartUp.vTelephone = StartUp.xTDdata[k][5];
//		StartUp.vSex = StartUp.xTDdata[k][6];
//		StartUp.vBirthday = StartUp.xTDdata[k][7];
//		StartUp.vReligion = StartUp.xTDdata[k][8];
//		StartUp.vEthnicity = StartUp.xTDdata[k][9];
//		StartUp.vNationnality = StartUp.xTDdata[k][10];
//		StartUp.vHouse = StartUp.xTDdata[k][11];
//		StartUp.vidCard = StartUp.xTDdata[k][12];
//		StartUp.vRelationship = StartUp.xTDdata[k][13];
//		StartUp.vNameSpouse = StartUp.xTDdata[k][45];
//		StartUp.vidCardSpouse = StartUp.xTDdata[k][46];
//		StartUp.vNationnalitySpouse = StartUp.xTDdata[k][47];
//		StartUp.vDateMarry = StartUp.xTDdata[k][48];
//		StartUp.vAddressSpouse = StartUp.xTDdata[k][49];
//		StartUp.vDo = StartUp.xTDdata[k][14];
//		StartUp.vAddress = StartUp.xTDdata[k][15];
//		StartUp.vAccommodation = StartUp.xTDdata[k][16];
//		StartUp.vAddressNow = StartUp.xTDdata[k][17];
//		StartUp.vAccommodationNow = StartUp.xTDdata[k][18];
//		StartUp.vStartAddressNow = StartUp.xTDdata[k][19];
//		StartUp.vEndAddressNow = StartUp.xTDdata[k][20];
//		StartUp.vAddressBefore = StartUp.xTDdata[k][21];
//		StartUp.vAccommodationBefore = StartUp.xTDdata[k][22];
//		StartUp.vStartAddressBefore = StartUp.xTDdata[k][23];
//		StartUp.vEndAddressBefore = StartUp.xTDdata[k][24];
//		StartUp.vEducation = StartUp.xTDdata[k][25];
//		StartUp.vNameFather = StartUp.xTDdata[k][26];
//		StartUp.vStatusFather = StartUp.xTDdata[k][27];
//		StartUp.vBirthdayFather = StartUp.xTDdata[k][28];
//		StartUp.vidCardFather = StartUp.xTDdata[k][29];
//		StartUp.vEthnicityFather = StartUp.xTDdata[k][30];
//		StartUp.vNationnalityFather = StartUp.xTDdata[k][31];
//		StartUp.vCountryFather = StartUp.xTDdata[k][32];
//		StartUp.vAddressFather = StartUp.xTDdata[k][33];
//		StartUp.vNameMother = StartUp.xTDdata[k][34];
//		StartUp.vStatusMother = StartUp.xTDdata[k][35];
//		StartUp.vBirthdayMother = StartUp.xTDdata[k][36];
//		StartUp.vidCardMother = StartUp.xTDdata[k][37];
//		StartUp.vEthnicityMother = StartUp.xTDdata[k][38];
//		StartUp.vNationnalityMother = StartUp.xTDdata[k][39];
//		StartUp.vCountryMother = StartUp.xTDdata[k][40];
//		StartUp.vAddressMother = StartUp.xTDdata[k][41];
//		StartUp.vUsername = StartUp.xTDdata[k][42];
//		StartUp.vPassword = StartUp.xTDdata[k][43];
//		StartUp.vConfirmPassword = StartUp.xTDdata[k][44];

//		StartUp.vDTResult = Integer.parseInt("51");
//		StartUp.vDTError = Integer.parseInt("53");

//		======== Login (03) ========		
			if (i == 2) {
				StartUp.vAPK = StartUp.xTDdata[k][2];
				StartUp.vUsername = StartUp.xTDdata[k][3];
				StartUp.vPassword = StartUp.xTDdata[k][4];
				StartUp.vDTResult = Integer.parseInt("6");
				StartUp.vDTError = Integer.parseInt("8");
			}

//		======== SelectStaffForRequest (05) ========		
			if (i == 3) {
				StartUp.vAPK = StartUp.xTDdata[k][2];
				StartUp.vUsername = StartUp.xTDdata[k][3];
				StartUp.vPassword = StartUp.xTDdata[k][4];
				StartUp.vConfirm = StartUp.xTDdata[k][5];
				StartUp.vSelectStaff = StartUp.xTDdata[k][6];
				StartUp.vConfirmProcess = StartUp.xTDdata[k][7];
				StartUp.vClose = StartUp.xTDdata[k][2];
				StartUp.vDTResult = Integer.parseInt("9");
				StartUp.vDTError = Integer.parseInt("11");
			}

//		======== GiveSuggestion (06) ========		
			if (i == 4) {
				StartUp.vAPK = StartUp.xTDdata[k][2];
				StartUp.vUsername = StartUp.xTDdata[k][3];
				StartUp.vPassword = StartUp.xTDdata[k][4];
				StartUp.vFact = StartUp.xTDdata[k][5];
				StartUp.vFactMotherFather = StartUp.xTDdata[k][6];
				StartUp.vRule = StartUp.xTDdata[k][7];
				StartUp.vStatus = StartUp.xTDdata[k][8];
				StartUp.vConfirmProcess = StartUp.xTDdata[k][9];
				StartUp.vClose = StartUp.xTDdata[k][2];
				StartUp.vDTResult = Integer.parseInt("11");
				StartUp.vDTError = Integer.parseInt("13");
			}

//		======== RequestForHelp (08) ========		
//		StartUp.vAPK = StartUp.xTDdata[k][2];
//		StartUp.vUsername = StartUp.xTDdata[k][3];
//		StartUp.vPassword = StartUp.xTDdata[k][4];
//		StartUp.vPassword = StartUp.xTDdata[k][4];
//		StartUp.vRadioBirth = StartUp.xTDdata[k][5];
//		StartUp.vRadioRegis = StartUp.xTDdata[k][6];
//		StartUp.vRadioIdCard = StartUp.xTDdata[k][7];
//		StartUp.vRadioCenter = StartUp.xTDdata[k][8];
//		StartUp.vChkBirth = StartUp.xTDdata[k][9];
//		StartUp.vDTResult = Integer.parseInt("11");
//		StartUp.vDTError = Integer.parseInt("13");

//		======== AddMoreRequest (04) ========		
//		StartUp.vAPK = StartUp.xTDdata[k][2];
//		StartUp.vUsername = StartUp.xTDdata[k][3];
//		StartUp.vPassword = StartUp.xTDdata[k][4];
//		StartUp.vMoreRequest = StartUp.xTDdata[k][5];
//		StartUp.vDTResult = Integer.parseInt("7");
//		StartUp.vDTError = Integer.parseInt("9");

//		======== AnswerMoreRequest (07) ========	
			if (i == 5) {
				StartUp.vAPK = StartUp.xTDdata[k][2];
				StartUp.vUsername = StartUp.xTDdata[k][3];
				StartUp.vPassword = StartUp.xTDdata[k][4];
				StartUp.vMessage = StartUp.xTDdata[k][5];
				StartUp.vConfirmProcess = StartUp.xTDdata[k][6];
				StartUp.vDTResult = Integer.parseInt("8");
				StartUp.vDTError = Integer.parseInt("10");
			}
		}
	}
}